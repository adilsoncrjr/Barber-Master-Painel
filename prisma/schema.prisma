generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")     // pooler :6543
  directUrl = env("DIRECT_URL")       // direct :5432
}

model SuperAdmin {
  id           String   @id @default(cuid())
  email        String   @unique
  passwordHash String   @map("password_hash")
  createdAt    DateTime @default(now()) @map("created_at")

  @@map("super_admins")
}

model Barbershop {
  id        String   @id @default(uuid())
  name      String
  slug      String   @unique
  status    String   @default("active")  // active | inactive
  plan      String   @default("trial")   // trial | start | pro
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  users     User[]

  @@map("barbershops")
}

model User {
  id           String   @id @default(uuid())

  barbershopId String   @map("barbershop_id")
  barbershop   Barbershop @relation(fields: [barbershopId], references: [id], onDelete: Cascade)

  role         String    @default("client")  // admin | barber | client
  name         String
  phone        String
  passwordHash String?   @map("password_hash")
  isActive     Boolean   @default(true) @map("is_active")
  createdAt    DateTime  @default(now()) @map("created_at")

  @@unique([barbershopId, phone])
  @@map("users")
}